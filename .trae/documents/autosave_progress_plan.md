# ToolMedia3 - 自动保存播放进度功能实现计划

## [x] 任务1：在BaseVideoView中添加自动保存进度的开关控制
- **优先级**：P0
- **依赖**：无
- **描述**：
  - 在BaseVideoView中添加一个变量，用于控制是否启用自动保存播放进度的功能
  - 添加一个方法，用于设置是否启用自动保存播放进度的功能
  - 修改setVideoSource方法，根据开关状态决定是否调用startAutoSaveProgress方法
- **成功标准**：
  - BaseVideoView能够根据开关状态决定是否启用自动保存播放进度的功能
- **测试要求**：
  - `programmatic` TR-1.1：编译无错误
  - `human-judgement` TR-1.2：能够通过代码控制是否启用自动保存播放进度的功能
- **注意**：确保修改不会影响其他功能

## [x] 任务2：在MainActivity的布局中添加自动保存进度的开关控件
- **优先级**：P0
- **依赖**：任务1
- **描述**：
  - 在activity_main.xml布局文件中添加一个开关控件（Switch），用于让用户选择是否启用自动保存播放进度的功能
  - 为开关控件添加适当的标签和提示文本
- **成功标准**：
  - 布局文件中包含一个开关控件，用于控制自动保存播放进度的功能
- **测试要求**：
  - `programmatic` TR-2.1：编译无错误
  - `human-judgement` TR-2.2：开关控件在布局中显示正常
- **注意**：确保开关控件的布局合理，不会影响其他控件的显示

## [x] 任务3：在MainActivity中处理开关控件的状态变化
- **优先级**：P0
- **依赖**：任务2
- **描述**：
  - 在MainActivity中为开关控件添加状态变化监听器
  - 当开关状态变化时，调用BaseVideoView的方法来启用或禁用自动保存播放进度的功能
- **成功标准**：
  - 开关控件的状态变化能够正确反映到BaseVideoView的自动保存播放进度的功能上
- **测试要求**：
  - `programmatic` TR-3.1：编译无错误
  - `human-judgement` TR-3.2：切换开关状态时，能够正确启用或禁用自动保存播放进度的功能
- **注意**：确保开关控件的初始状态与BaseVideoView的自动保存播放进度的功能状态一致

## [x] 任务4：保存开关状态到SharedPreferences
- **优先级**：P1
- **依赖**：任务3
- **描述**：
  - 在MainActivity中，将开关控件的状态保存到SharedPreferences中
  - 在MainActivity启动时，从SharedPreferences中加载开关控件的状态
- **成功标准**：
  - 开关控件的状态能够在应用重启后保持
- **测试要求**：
  - `programmatic` TR-4.1：编译无错误
  - `human-judgement` TR-4.2：应用重启后，开关控件的状态与之前设置的一致
- **注意**：确保SharedPreferences的操作在主线程之外进行，避免阻塞UI

## [x] 任务5：测试和验证
- **优先级**：P1
- **依赖**：任务4
- **描述**：
  - 测试自动保存播放进度功能的启用和禁用
  - 测试应用重启后开关状态的保持
  - 测试播放进度的保存和加载
- **成功标准**：
  - 所有测试场景都能正常处理
  - 自动保存播放进度的功能能够根据开关状态正确启用或禁用
- **测试要求**：
  - `human-judgement` TR-5.1：启用开关后，播放进度能够自动保存
  - `human-judgement` TR-5.2：禁用开关后，播放进度不会自动保存
  - `human-judgement` TR-5.3：应用重启后，开关状态与之前设置的一致
- **注意**：测试不同类型的视频，确保自动保存播放进度的功能在各种情况下都能正常工作